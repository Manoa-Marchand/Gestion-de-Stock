<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Gestion Logistique</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
    <h1>Dashboard</h1>
    <p id="welcomeMessage">Chargement...</p>
    <button id="logoutBtn">Se déconnecter</button>
</div>

<script>
    // Récupération des infos de session
    fetch("/dashboard", { credentials: "same-origin" })
    .then(res => {
        if(res.status === 401){
            window.location.href = "/login.html"; // pas connecté
            return;
        }
        return res.json();
    })
    .then(data => {
        if(data){
            const msg = document.getElementById("welcomeMessage");
            msg.textContent = `Bienvenue ${data.nom} (${data.role})`;
        }
    })
    .catch(err => console.error(err));

    // Déconnexion
    document.getElementById("logoutBtn").addEventListener("click", () => {
        fetch("/logout", { method: "POST", credentials: "same-origin" })
        .then(() => window.location.href = "/index.html")
        .catch(err => console.error(err));
    });
</script>
</body>
</html>